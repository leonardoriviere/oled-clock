<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>Clock</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300&display=swap" rel="stylesheet">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  background: #000;
  overflow: hidden;
  cursor: none;
  user-select: none;
  -webkit-user-select: none;
  width: 100vw;
  height: 100vh;
  position: relative;
}
#clock {
  position: absolute;
  font-family: 'Manrope', sans-serif;
  font-weight: 300;
  font-size: 4vw;
  color: rgba(255, 255, 255, 0.03);
  letter-spacing: -0.03em;
  line-height: 1;
  white-space: nowrap;
}
</style>
</head>
<body>
<div id="clock"></div>
<script>
var clock = document.getElementById('clock');

// === Prevent screensaver: multiple strategies ===
(function preventScreensaver() {

  // Strategy 1: Canvas-based video stream (most reliable for smart TVs)
  // Creates a real video stream that the TV recognizes as active media
  try {
    var canvas = document.createElement('canvas');
    canvas.width = 1;
    canvas.height = 1;
    var ctx = canvas.getContext('2d');
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, 1, 1);
    var stream = canvas.captureStream(1);
    var video = document.createElement('video');
    video.style.cssText = 'position:fixed;top:-1px;left:-1px;width:1px;height:1px;opacity:0.01';
    video.srcObject = stream;
    video.muted = true;
    video.playsInline = true;
    document.body.appendChild(video);
    video.play().catch(function() {});
  } catch (e) {}

  // Strategy 2: Silent audio oscillator via Web Audio API
  try {
    var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    var osc = audioCtx.createOscillator();
    var gain = audioCtx.createGain();
    gain.gain.value = 0.001;
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
  } catch (e) {}

  // Strategy 3: Periodic synthetic user activity (mousemove events)
  setInterval(function() {
    document.dispatchEvent(new MouseEvent('mousemove', {
      clientX: Math.random() * window.innerWidth,
      clientY: Math.random() * window.innerHeight
    }));
  }, 30000);

  // Strategy 4: Wake Lock API
  if ('wakeLock' in navigator) {
    function requestWakeLock() {
      navigator.wakeLock.request('screen').catch(function() {});
    }
    requestWakeLock();
    document.addEventListener('visibilitychange', function() {
      if (document.visibilityState === 'visible') requestWakeLock();
    });
  }

  // Strategy 5: Periodic title change (some browsers track DOM activity)
  var titleFlip = false;
  setInterval(function() {
    titleFlip = !titleFlip;
    document.title = titleFlip ? 'Clock' : 'Clock ';
  }, 30000);

})();

function pad(n) {
  return n < 10 ? '0' + n : '' + n;
}

function updateClock() {
  const now = new Date();
  clock.textContent = pad(now.getHours()) + ':' + pad(now.getMinutes());
}

function reposition() {
  const rect = clock.getBoundingClientRect();
  const maxX = window.innerWidth - rect.width;
  const maxY = window.innerHeight - rect.height;
  clock.style.left = Math.floor(Math.random() * Math.max(0, maxX)) + 'px';
  clock.style.top = Math.floor(Math.random() * Math.max(0, maxY)) + 'px';
}

function toggleFullscreen() {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().catch(function() {});
  } else {
    document.exitFullscreen().catch(function() {});
  }
}

updateClock();
setInterval(updateClock, 1000);

reposition();
setInterval(reposition, 300000);

document.addEventListener('click', toggleFullscreen);
window.addEventListener('resize', reposition);
</script>
</body>
</html>
